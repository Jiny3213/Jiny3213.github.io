---
title: 小程序 webview 能否替代uniapp等小程序框架?
tags: 前端
---

众所周知，小程序开发流程非常麻烦,难以工程化,很难使用现代化的前端工具链,于是就出了mpvue,uniapp等框架,封装了小程序的api使得开发者能够用vue的语法来开发小程序。

而小程序提供了 webview，如果用原生 vue 开发之后套进 webview 中，在通过通讯api调用小程序原生功能，是否能够摆脱小程序固有的开发流程呢？

## 适用条件
首先，个人类型的小程序暂不支持使用 webview，因此个人开发者就不能使用这种开发模式了。

其次，webview 需要为每个你打开的页面配置业务域名, 不能随心所欲地调用第三方服务, 比如调用支付宝支付。

## 小程序与 webview 信息交互

### webview 向 小程序 传递消息

postMessage：会在特定时机（小程序后退、组件销毁、分享）触发并收到消息，这意味着常规交互过程中无法触发，很难主动向小程序发送消息。

navigateTo: 跳转指定的小程序页面，并保存当前页面状态，可以传递参数。能够即时向小程序发送消息，缺点是必须跳转一个小程序的页面。由于接收不到 eventChannel 的数据，返回时也不能携带任何参数回到原来的页面。

### 小程序 向 webview 传递消息

只能在 webview 的 src 字段传递参数，意味着你传递参数的同时会重新渲染页面

## 常规应用开发流程

### 一、登录

登录需要在小程序端调用 `wx.login` 获取 code 发送到服务器完成登录

先登录再渲染 webview, 把登录后的数据以 url 字符串的形式传入 webview, 缺点是登录时需要等待一段时间; 先渲染 webview 再登录, 则需要跳转一次页面, 再重新渲染 webview, 用户体验更差。
